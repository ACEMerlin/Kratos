Kratos
=============

![Logo](images/logo.jpg)

Provide basic __Double Binding(Data Binding)__ feature on Android.

* Using annotation to generate boilerplate code.
* Bind view and data to help you clean your code.


 Example
----------------

### Data Binding

The following code demostrate that two views(EditText and TextView) bound to one single data(which in the code `boundData` holds the data. you can later access or change the data by using `boundDate.data`)

```java
public class SimpleActivity extends Activity {

    @BindText({R.id.test_doublebinding_input, R.id.test_doublebinding_presenter})
    KString boundData = new KString();

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_simple);
        Kratos.bind(this);
    }
}
```
The presenter(TextView) will behave exactly the same as input(EditText) since they were bound to the same data:

![Example](images/example.gif)

What if you want yourself a custom update behavior than the default update method when data changes? You can add custom update function to update view:

```java
@BindText(R.id.some_edittext_id)
KString boundData = new KString(new KString.Update() {
    @Override
    public void update(@NotNull View view, @NotNull String s) {
        EditText et = (EditText)view;          //Add custom update function here.
        int start = et.getSelectionStart();    // This code is the same as: public KString boundData1 = new KString(),
        et.setText(s);                         // since this custom function is the same as the default function.
        et.setSelection(start);
    }
});
```
If you are using Kotlin, the code is more simple:

```java
@BindString("some_edittext_id")
public var boundData = KString {
    it, new ->
    it as EditText
    val position = this.selectionStart
    this.setText(new)
    this.setSelection(position)
}
```

### Card

__The concept of Card is very important in Kratos.__

Basically, every view is a card, each activity is generated by one sigle json file, a little bit like html. 

The goal is to impletment each view as a card,
and then easily reuse them by manipulating json file.

For example, the following activity is generated from [`sample.json`][4] file. 

![Card](images/card.gif)

You can easily handle click event by override `onEventMainThread` method.

Notice that Kratos uses toolbar by default, so you need a `NoActionBar` theme in your style file, or you can just use `KratosTheme`.

#### What's the benefit

* No more fear of the changing requirements. Since activities are generated from json file, you can manipulate the layout on the fly(imagine put the json file on a server, like htmt on website).
* No more redundant code. Since each view is a card, you can reuse views easily by manipulate the json file.
* Easily create custom views. All you need to do is to extend KCard, create you own KData and bind the data to the card(must set package to `kratos.card` in your custom card, so that kratos can find it). You can implement rather complex card using kratos dependeng on your skills. For example, all the view in the following activity are card: 

![ComplexCard](images/complexcard.png)

For more code see kratos-sample.

Download
-----------------
__Kratos is still under development and a lot of features haven't been added to it yet.__ But the basic idea is here. If you are interested in this project, feel free to fork.

Kratos is available from maven central:

```groovy
apply plugin: 'com.neenbedankt.android-apt'
buildscript {
    ext.kratos_version = '0.1.1'
    repositories {
        mavenCentral()
    }
    dependencies {
        classpath 'com.neenbedankt.gradle.plugins:android-apt:1.8'
    }
}

dependencies {
    compile "com.github.acemerlin:kratos:$kratos_version"
    apt "com.github.acemerlin:kratos-compiler:$kratos_version"
}
```

How It Works
----------------
* Use Kotlin's [Observable Delegate][1] to listen to changes made to certian property.
* Use Kotlin's [Extension][2] feature to add functions to View.
* Use Annotation Processor to generate code which binds the data and the view(or views).


Lisence
----------------
[GNU GENERAL PUBLIC LICENSE Version 3][3]

[1]: https://kotlinlang.org/docs/reference/delegated-properties.html#observable
[2]: https://kotlinlang.org/docs/reference/extensions.html
[3]: http://www.gnu.org/licenses/gpl-3.0.en.html
[4]: https://github.com/ACEMerlin/Kratos/blob/feature/card/kratos-sample/src/main/res/raw/sample.json